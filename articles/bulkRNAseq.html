<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analysis of bulk RNA-seq data • GSVAEuroBioC2024</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Analysis of bulk RNA-seq data">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GSVAEuroBioC2024</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/importGMTfiles.html">Import gene sets from GMT files</a>
    </li>
    <li>
      <a href="../articles/bulkRNAseq.html">Analysis of bulk RNA-seq data</a>
    </li>
    <li>
      <a href="../articles/scRNA-seq.html">Analysis of single-cell RNA-seq data</a>
    </li>
    <li>
      <a href="../articles/spatia.html">Analysis of spatial omics data</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/functionalgenomics/GSVAEuroBioC2024" class="external-link">
    <span class="fa fa-github"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Analysis of bulk RNA-seq data</h1>
                        <h4 data-toc-skip class="author">Axel Klenk</h4>
            <address class="author_afil">
      Dept. of Medicine and Life Sciences, Universitat Pompeu Fabra, Barcelona<br><a class="author_email" href="mailto:#"></a><a href="mailto:axelvolker.klenk@upf.edu" class="email">axelvolker.klenk@upf.edu</a>
      </address>
                              <h4 data-toc-skip class="author">Robert Castelo</h4>
            <address class="author_afil">
      Dept. of Medicine and Life Sciences, Universitat Pompeu Fabra, Barcelona<br><a class="author_email" href="mailto:#"></a><a href="mailto:robert.castelo@upf.edu" class="email">robert.castelo@upf.edu</a>
      </address>
                  
            <h4 data-toc-skip class="date">2024-09-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/functionalgenomics/GSVAEuroBioC2024/blob/devel/vignettes/bulkRNAseq.Rmd" class="external-link"><code>vignettes/bulkRNAseq.Rmd</code></a></small>
      <div class="hidden name"><code>bulkRNAseq.Rmd</code></div>

    </div>

    
    
<p>Vignette built using <code>GSVA</code>, version 1.53.16.</p>
<div class="section level2" number="1">
<h2 id="importing-bulk-rna-seq-data-into-a-summarizedexperiment-object">
<span class="header-section-number">1</span> Importing bulk RNA-seq data into a <code>SummarizedExperiment</code> object<a class="anchor" aria-label="anchor" href="#importing-bulk-rna-seq-data-into-a-summarizedexperiment-object"></a>
</h2>
<p>We will illustrate how to use GSVA with the bulk RNA-seq data from
<span class="citation">(<a href="#ref-costa2021genome">Costa et al. 2021</a>)</span>. This dataset consists of stranded 2x75nt paired-end
reads sequenced from whole blood stored in
<a href="https://en.wikipedia.org/wiki/Dried_blood_spot" class="external-link">dried blood spots (DBS)</a>.
<span class="citation">Costa et al. (<a href="#ref-costa2021genome">2021</a>)</span> generated these data from 21 DBS samples of extremely
preterm newborns (neonates born before the 28th week of gestation), where 10 of
them had been exposed to a fetal inflammatory response (FIR) before birth.</p>
<p>We start by building a
<a href="https://bioconductor.org/packages/SummarizedExperiment" class="external-link">SummarizedExperiment</a>
object from these RNA-seq data. A corresponding matrix of normalized log-CPM
units of expression is stored as part of this workshop package, where
lowly-expressed genes have been already filtered out. We should load these data
as follows.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fname</span> <span class="op">&lt;-</span> <span class="st">"CostaEtAl2021_FIRDBS_bulkRNAseq_data_ENTREZID.csv.gz"</span></span>
<span><span class="va">fname</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="va">fname</span><span class="op">)</span>,</span>
<span>                     package<span class="op">=</span><span class="st">"GSVAEuroBioC2024"</span><span class="op">)</span></span>
<span><span class="va">expr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">fname</span>, row.names<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">expr</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 11279    21</span></span>
<span><span class="va">expr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span></span>
<span><span class="co">#&gt;               BS03     BS04     BS05     BS06     BS07     BS08     BS09</span></span>
<span><span class="co">#&gt; 100       1.907142 2.378443 1.416999 2.688953 2.541277 2.807271 3.299930</span></span>
<span><span class="co">#&gt; 10000     4.669820 4.492745 4.380702 5.134757 4.893896 4.408717 4.921101</span></span>
<span><span class="co">#&gt; 100008587 6.388405 7.167047 4.472078 6.851124 6.868794 4.531868 5.141607</span></span>
<span><span class="co">#&gt; 100009676 1.849203 1.467252 1.928039 1.266955 2.033022 1.369181 2.742960</span></span>
<span><span class="co">#&gt; 10001     4.463245 4.288214 4.075431 4.294054 4.220348 4.095428 4.033399</span></span></code></pre></div>
<p>Note that gene (row) identifiers correspond to
<a href="https://www.ncbi.nlm.nih.gov/gene" class="external-link">NCBI Entrez gene identifiers</a>, while sample
(column) identifiers correspond to anonymized neonates. This workshop package
also stores phenotype data describing the exposure to FIR and the sex of the
neonate.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fname</span> <span class="op">&lt;-</span> <span class="st">"CostaEtAl2021_FIRDBS_phenotype_data.csv.gz"</span></span>
<span><span class="va">fname</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="va">fname</span><span class="op">)</span>,</span>
<span>                     package<span class="op">=</span><span class="st">"GSVAEuroBioC2024"</span><span class="op">)</span></span>
<span><span class="va">pdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">fname</span>, row.names<span class="op">=</span><span class="fl">1</span>, stringsAsFactors<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">pdat</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 21  2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pdat</span><span class="op">)</span></span>
<span><span class="co">#&gt;      FIR    Sex</span></span>
<span><span class="co">#&gt; BS03 yes female</span></span>
<span><span class="co">#&gt; BS04 yes female</span></span>
<span><span class="co">#&gt; BS05 yes   male</span></span>
<span><span class="co">#&gt; BS06  no female</span></span>
<span><span class="co">#&gt; BS07  no female</span></span>
<span><span class="co">#&gt; BS08 yes   male</span></span></code></pre></div>
<p>We can observe that we have expression profiles for all four possible
combinations of FIR exposure and sex.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">pdat</span><span class="op">$</span><span class="va">FIR</span>, <span class="va">pdat</span><span class="op">$</span><span class="va">Sex</span><span class="op">)</span></span>
<span><span class="co">#&gt;      </span></span>
<span><span class="co">#&gt;       female male</span></span>
<span><span class="co">#&gt;   no       4    7</span></span>
<span><span class="co">#&gt;   yes      4    6</span></span></code></pre></div>
<p>We finally build the <code>SummarizedExperiment</code> object using the
<code><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">SummarizedExperiment()</a></code> constructor function from the
<a href="https://bioconductor.org/packages/SummarizedExperiment" class="external-link">SummarizedExperiment</a>
package. Prior to that call, we make sure that newborn identifiers in
the columns of the expression data are identical to the row identifiers
in the phenotype data. If this were not the case, then we must have made
some mistake when loading the CSV files into the <code>data.frame</code> objects
<code>expr</code> and <code>pdat</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/SummarizedExperiment" class="external-link">SummarizedExperiment</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## QC, make sure this line gives no error</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">expr</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">pdat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">SummarizedExperiment</a></span><span class="op">(</span>assay<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>logCPM<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">expr</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                           colData<span class="op">=</span><span class="va">pdat</span><span class="op">)</span></span>
<span><span class="va">se</span></span>
<span><span class="co">#&gt; class: SummarizedExperiment </span></span>
<span><span class="co">#&gt; dim: 11279 21 </span></span>
<span><span class="co">#&gt; metadata(0):</span></span>
<span><span class="co">#&gt; assays(1): logCPM</span></span>
<span><span class="co">#&gt; rownames(11279): 100 10000 ... 9994 9997</span></span>
<span><span class="co">#&gt; rowData names(0):</span></span>
<span><span class="co">#&gt; colnames(21): BS03 BS04 ... BS23 BS24</span></span>
<span><span class="co">#&gt; colData names(2): FIR Sex</span></span></code></pre></div>
<p>To facilitate later on the automatic mapping of gene identifiers between
gene sets and RNA-seq data, we should add annotation metadata to the
<code>SummarizedExperiment</code> object as follows.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">GSEABase</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rcastelo/GSVA" class="external-link">GSVA</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/GSVA/man/gsvaAnnotation.html" class="external-link">gsvaAnnotation</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GSEABase/man/GeneIdentifierType-constructors.html" class="external-link">EntrezIdentifier</a></span><span class="op">(</span><span class="st">"org.Hs.eg.db"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2" number="2">
<h2 id="data-exploration-at-gene-level">
<span class="header-section-number">2</span> Data exploration at gene level<a class="anchor" aria-label="anchor" href="#data-exploration-at-gene-level"></a>
</h2>
<p>We do a brief data exploration at gene level, to have a sense of what can
we expect in our analysis at pathway level. Figure <a href="#fig:genelevelmds">2.1</a>
below shows the projection in two dimensions of sample dissmilarity by means
of a
<a href="https://en.wikipedia.org/wiki/Multidimensional_scaling" class="external-link">multidimensional scaling (MDS)</a>
plot, produced with the <code><a href="https://rdrr.io/pkg/limma/man/plotMDS.html" class="external-link">plotMDS()</a></code> function of the Bioconductor package
<a href="https://bioconductor.org/packages/limma" class="external-link">limma</a>. We can observe that sample
dissimilarity in RNA expression from DBS samples is driven by the FIR and sex
phenotypes, as shown in Fig. 1C of <span class="citation">Costa et al. (<a href="#ref-costa2021genome">2021</a>)</span>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioinf.wehi.edu.au/limma/" class="external-link">limma</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">fircolor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>no<span class="op">=</span><span class="st">"skyblue"</span>, yes<span class="op">=</span><span class="st">"darkred"</span><span class="op">)</span></span>
<span><span class="va">sexpch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>female<span class="op">=</span><span class="fl">19</span>, male<span class="op">=</span><span class="fl">15</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/limma/man/plotMDS.html" class="external-link">plotMDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span>, col<span class="op">=</span><span class="va">fircolor</span><span class="op">[</span><span class="va">se</span><span class="op">$</span><span class="va">FIR</span><span class="op">]</span>, pch<span class="op">=</span><span class="va">sexpch</span><span class="op">[</span><span class="va">se</span><span class="op">$</span><span class="va">Sex</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:genelevelmds"></span>
<img src="bulkRNAseq_files/figure-html/genelevelmds-1.png" alt="Gene-level exploration. Multidimensional scaling (MDS) plot at gene level. Red corresponds to `FIR=yes` and blue to `FIR=no`, while circles and squares correspond, respectively, to female and male neonates."><p class="caption">
Figure 2.1: Gene-level exploration. Multidimensional scaling (MDS) plot at gene level. Red corresponds to <code>FIR=yes</code> and blue to <code>FIR=no</code>, while circles and squares correspond, respectively, to female and male neonates.
</p>
</div>
</div>
<div class="section level2" number="3">
<h2 id="importing-gene-sets">
<span class="header-section-number">3</span> Importing gene sets<a class="anchor" aria-label="anchor" href="#importing-gene-sets"></a>
</h2>
<p><span class="citation">Costa et al. (<a href="#ref-costa2021genome">2021</a>)</span> report a postnatal activation of the innate immune system
and an impairment of the adaptive immunity. For the purpose of exploring these
results at pathway level, we will download the C7 collection of immunologic
signature gene sets from
<a href="https://www.gsea-msigdb.org/gsea/msigdb/human/collection_details.jsp#C7" class="external-link">MSigDB</a>,
concretely the subcollection ImmuneSigDB. Here we use the GSVA function
<code><a href="https://rdrr.io/pkg/GSVA/man/readGMT.html" class="external-link">readGMT()</a></code>, which allow us to directly download the GMT file from the MSigDB
database.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">URL</span> <span class="op">&lt;-</span> <span class="st">"https://data.broadinstitute.org/gsea-msigdb/msigdb/release/2023.2.Hs/c7.immunesigdb.v2023.2.Hs.symbols.gmt"</span></span>
<span><span class="va">genesets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GSVA/man/readGMT.html" class="external-link">readGMT</a></span><span class="op">(</span><span class="va">URL</span>, geneIdType<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/GSEABase/man/GeneIdentifierType-constructors.html" class="external-link">SymbolIdentifier</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>However, for the purpose of this workshop, if we have problems accessing that
URL, we can also load a compressed version stored in the workshop package, as
follows.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fname</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"c7.immunesigdb.v2023.2.Hs.symbols.gmt.gz"</span>,</span>
<span>                     package<span class="op">=</span><span class="st">"GSVAEuroBioC2024"</span><span class="op">)</span></span>
<span><span class="va">genesets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GSVA/man/readGMT.html" class="external-link">readGMT</a></span><span class="op">(</span><span class="va">fname</span>, geneIdType<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/GSEABase/man/GeneIdentifierType-constructors.html" class="external-link">SymbolIdentifier</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">genesets</span></span>
<span><span class="co">#&gt; GeneSetCollection</span></span>
<span><span class="co">#&gt;   names: GOLDRATH_EFF_VS_MEMORY_CD8_TCELL_DN, GOLDRATH_EFF_VS_MEMORY_CD8_TCELL_UP, ..., KAECH_NAIVE_VS_MEMORY_CD8_TCELL_UP (4872 total)</span></span>
<span><span class="co">#&gt;   unique identifiers: ABCA2, ABCC5, ..., LINC00841 (20457 total)</span></span>
<span><span class="co">#&gt;   types in collection:</span></span>
<span><span class="co">#&gt;     geneIdType: SymbolIdentifier (1 total)</span></span>
<span><span class="co">#&gt;     collectionType: NullCollection (1 total)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">genesets</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4872</span></span></code></pre></div>
<p>The argument <code>geneIdType=SymbolIdentifier()</code> adds metadata so that the
resulting <code>GeneSetCollection</code> object knows that the gene identifiers employed
in this gene set collection correspond to
<a href="https://www.genenames.org" class="external-link">HUGO symbols</a>.</p>
<p>To reduce the execution time in this workshop, we are going to select a subset
of gene sets that are more relevant to our data. Concretely, we select gene
sets formed by genes upregulated in innate leukocytes and adaptive mature
lymphocytes, excluding those reported in studies on myeloid cells and the lupus
autoimmune disease.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">innatepat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NKCELL_VS_.+_UP"</span>, <span class="st">"MAST_CELL_VS_.+_UP"</span>,</span>
<span>               <span class="st">"EOSINOPHIL_VS_.+_UP"</span>, <span class="st">"BASOPHIL_VS_.+_UP"</span>,</span>
<span>               <span class="st">"MACROPHAGE_VS_.+_UP"</span>, <span class="st">"NEUTROPHIL_VS_.+_UP"</span><span class="op">)</span></span>
<span><span class="va">innatepat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">innatepat</span>, collapse<span class="op">=</span><span class="st">"|"</span><span class="op">)</span></span>
<span><span class="va">innategsets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">genesets</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="va">innatepat</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">genesets</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">innategsets</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 53</span></span>
<span></span>
<span><span class="va">adaptivepat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CD4_TCELL_VS_.+_UP"</span>, <span class="st">"CD8_TCELL_VS_.+_UP"</span>, <span class="st">"BCELL_VS_.+_UP"</span><span class="op">)</span></span>
<span><span class="va">adaptivepat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">adaptivepat</span>, collapse<span class="op">=</span><span class="st">"|"</span><span class="op">)</span></span>
<span><span class="va">adaptivegsets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">genesets</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="va">adaptivepat</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">genesets</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">excludepat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NAIVE"</span>, <span class="st">"LUPUS"</span>, <span class="st">"MYELOID"</span><span class="op">)</span></span>
<span><span class="va">excludepat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">excludepat</span>, collapse<span class="op">=</span><span class="st">"|"</span><span class="op">)</span></span>
<span><span class="va">adaptivegsets</span> <span class="op">&lt;-</span> <span class="va">adaptivegsets</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="va">excludepat</span>, <span class="va">adaptivegsets</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">adaptivegsets</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 97</span></span>
<span></span>
<span><span class="va">genesets</span> <span class="op">&lt;-</span> <span class="va">genesets</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">innategsets</span>, <span class="va">adaptivegsets</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">genesets</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 150</span></span></code></pre></div>
</div>
<div class="section level2" number="4">
<h2 id="how-to-run-gsva">
<span class="header-section-number">4</span> How to run GSVA<a class="anchor" aria-label="anchor" href="#how-to-run-gsva"></a>
</h2>
<p>A GSVA analysis has two main inputs, the molecular data (e.g., gene expression),
and a collection of gene sets, and we run it in two steps. First, we should
build a parameter object for the desired methodology. Here we use the GSVA
algorithm of <span class="citation">Hänzelmann, Castelo, and Guinney (<a href="#ref-hanzelmann2013gsva">2013</a>)</span> by calling the function <code><a href="https://rdrr.io/pkg/GSVA/man/gsvaParam-class.html" class="external-link">gsvaParam()</a></code> (see the
<a href="https://bioconductor.org/packages/GSVA" class="external-link">GSVA</a> package vignette for other
functions implementing different pathway analysis methods).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gsvapar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GSVA/man/gsvaParam-class.html" class="external-link">gsvaParam</a></span><span class="op">(</span><span class="va">se</span>, <span class="va">genesets</span>, assay<span class="op">=</span><span class="st">"logCPM"</span>, minSize<span class="op">=</span><span class="fl">5</span>, maxSize<span class="op">=</span><span class="fl">300</span><span class="op">)</span></span>
<span><span class="va">gsvapar</span></span>
<span><span class="co">#&gt; A GSVA::gsvaParam object</span></span>
<span><span class="co">#&gt; expression data:</span></span>
<span><span class="co">#&gt;   class: SummarizedExperiment </span></span>
<span><span class="co">#&gt;   dim: 11279 21 </span></span>
<span><span class="co">#&gt;   metadata(1): annotation</span></span>
<span><span class="co">#&gt;   assays(1): logCPM</span></span>
<span><span class="co">#&gt;   rownames(11279): 100 10000 ... 9994 9997</span></span>
<span><span class="co">#&gt;   rowData names(0):</span></span>
<span><span class="co">#&gt;   colnames(21): BS03 BS04 ... BS23 BS24</span></span>
<span><span class="co">#&gt;   colData names(2): FIR Sex</span></span>
<span><span class="co">#&gt; using assay: logCPM</span></span>
<span><span class="co">#&gt; using annotation: none</span></span>
<span><span class="co">#&gt; gene sets:</span></span>
<span><span class="co">#&gt;   GeneSetCollection</span></span>
<span><span class="co">#&gt;     names: GSE18804_SPLEEN_MACROPHAGE_VS_BRAIN_TUMORAL_MACROPHAGE_UP, GSE18804_SPLEEN_MACROPHAGE_VS_COLON_TUMORAL_MACROPHAGE_UP, ..., GSE7460_CD8_TCELL_VS_TREG_ACT_UP (150 total)</span></span>
<span><span class="co">#&gt;     unique identifiers: ABCA8, ABLIM2, ..., ZFP30 (11353 total)</span></span>
<span><span class="co">#&gt;     types in collection:</span></span>
<span><span class="co">#&gt;       geneIdType: SymbolIdentifier (1 total)</span></span>
<span><span class="co">#&gt;       collectionType: NullCollection (1 total)</span></span>
<span><span class="co">#&gt; gene set size: [5, 300]</span></span>
<span><span class="co">#&gt; kcdf: auto</span></span>
<span><span class="co">#&gt; kcdfNoneMinSampleSize: 50</span></span>
<span><span class="co">#&gt; tau: 1</span></span>
<span><span class="co">#&gt; maxDiff: TRUE</span></span>
<span><span class="co">#&gt; absRanking: FALSE</span></span>
<span><span class="co">#&gt; sparse: TRUE</span></span></code></pre></div>
<p>In the second step, we call the <code><a href="https://rdrr.io/pkg/GSVA/man/gsva.html" class="external-link">gsva()</a></code> function with the parameter object
as its first argument, other arguments to this function control its verbosity
and parellel execution through the Bioconductor package
<a href="https://bioconductor.org/packages/BiocParallel" class="external-link">BiocParallel</a>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">es</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GSVA/man/gsva.html" class="external-link">gsva</a></span><span class="op">(</span><span class="va">gsvapar</span><span class="op">)</span></span>
<span><span class="co">#&gt; Mapping identifiers between gene sets and feature names.</span></span>
<span><span class="co">#&gt; Estimating GSVA scores for 150 gene sets.</span></span>
<span><span class="co">#&gt; Figuring out automatically how to estimate ECDFs</span></span>
<span><span class="co">#&gt; Estimating ECDFs with Gaussian kernels</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |===                                                                   |   5%  |                                                                              |=======                                                               |  10%  |                                                                              |==========                                                            |  14%  |                                                                              |=============                                                         |  19%  |                                                                              |=================                                                     |  24%  |                                                                              |====================                                                  |  29%  |                                                                              |=======================                                               |  33%  |                                                                              |===========================                                           |  38%  |                                                                              |==============================                                        |  43%  |                                                                              |=================================                                     |  48%  |                                                                              |=====================================                                 |  52%  |                                                                              |========================================                              |  57%  |                                                                              |===========================================                           |  62%  |                                                                              |===============================================                       |  67%  |                                                                              |==================================================                    |  71%  |                                                                              |=====================================================                 |  76%  |                                                                              |=========================================================             |  81%  |                                                                              |============================================================          |  86%  |                                                                              |===============================================================       |  90%  |                                                                              |===================================================================   |  95%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="va">es</span></span>
<span><span class="co">#&gt; class: SummarizedExperiment </span></span>
<span><span class="co">#&gt; dim: 150 21 </span></span>
<span><span class="co">#&gt; metadata(0):</span></span>
<span><span class="co">#&gt; assays(1): es</span></span>
<span><span class="co">#&gt; rownames(150):</span></span>
<span><span class="co">#&gt;   GSE18804_SPLEEN_MACROPHAGE_VS_BRAIN_TUMORAL_MACROPHAGE_UP</span></span>
<span><span class="co">#&gt;   GSE18804_SPLEEN_MACROPHAGE_VS_COLON_TUMORAL_MACROPHAGE_UP ...</span></span>
<span><span class="co">#&gt;   GSE7460_CD8_TCELL_VS_CD4_TCELL_ACT_UP</span></span>
<span><span class="co">#&gt;   GSE7460_CD8_TCELL_VS_TREG_ACT_UP</span></span>
<span><span class="co">#&gt; rowData names(1): gs</span></span>
<span><span class="co">#&gt; colnames(21): BS03 BS04 ... BS23 BS24</span></span>
<span><span class="co">#&gt; colData names(2): FIR Sex</span></span></code></pre></div>
<p>Because the input expression data was provided in a <code>SummmarizedExperiment</code>
object, the output of <code><a href="https://rdrr.io/pkg/GSVA/man/gsva.html" class="external-link">gsva()</a></code> is again a <code>SummarizedExperiment</code> object,
with two main differences with respect to the one given as input: (1)
the one or more matrices of molecular data in the assay slot of the input
object have been replaced by a single matrix of GSVA enrichment scores under
the assay name <code>es</code>; and (2) the collection of mapped and filtered gene sets
is included in the object and can be accessed using the methods <code><a href="https://rdrr.io/pkg/GSVA/man/geneSets.html" class="external-link">geneSets()</a></code>
and <code><a href="https://rdrr.io/pkg/GSVA/man/geneSets.html" class="external-link">geneSetSizes()</a></code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assayNames</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "logCPM"</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assayNames</a></span><span class="op">(</span><span class="va">es</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "es"</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">es</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="co">#&gt;                                                                  BS03</span></span>
<span><span class="co">#&gt; GSE18804_SPLEEN_MACROPHAGE_VS_BRAIN_TUMORAL_MACROPHAGE_UP -0.06952401</span></span>
<span><span class="co">#&gt; GSE18804_SPLEEN_MACROPHAGE_VS_COLON_TUMORAL_MACROPHAGE_UP  0.28088461</span></span>
<span><span class="co">#&gt; GSE18804_SPLEEN_MACROPHAGE_VS_TUMORAL_MACROPHAGE_UP       -0.13659475</span></span>
<span><span class="co">#&gt;                                                                 BS04</span></span>
<span><span class="co">#&gt; GSE18804_SPLEEN_MACROPHAGE_VS_BRAIN_TUMORAL_MACROPHAGE_UP  0.0530275</span></span>
<span><span class="co">#&gt; GSE18804_SPLEEN_MACROPHAGE_VS_COLON_TUMORAL_MACROPHAGE_UP -0.1305626</span></span>
<span><span class="co">#&gt; GSE18804_SPLEEN_MACROPHAGE_VS_TUMORAL_MACROPHAGE_UP        0.1634395</span></span>
<span><span class="co">#&gt;                                                                  BS05</span></span>
<span><span class="co">#&gt; GSE18804_SPLEEN_MACROPHAGE_VS_BRAIN_TUMORAL_MACROPHAGE_UP -0.13344892</span></span>
<span><span class="co">#&gt; GSE18804_SPLEEN_MACROPHAGE_VS_COLON_TUMORAL_MACROPHAGE_UP -0.08684864</span></span>
<span><span class="co">#&gt; GSE18804_SPLEEN_MACROPHAGE_VS_TUMORAL_MACROPHAGE_UP       -0.17536163</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/GSVA/man/geneSets.html" class="external-link">geneSets</a></span><span class="op">(</span><span class="va">es</span><span class="op">)</span>, <span class="va">head</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $GSE18804_SPLEEN_MACROPHAGE_VS_BRAIN_TUMORAL_MACROPHAGE_UP</span></span>
<span><span class="co">#&gt; [1] "8540" "1645" "302"  "314"  "328"  "9582"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $GSE18804_SPLEEN_MACROPHAGE_VS_COLON_TUMORAL_MACROPHAGE_UP</span></span>
<span><span class="co">#&gt; [1] "51703" "136"   "29880" "240"   "64682" "313"  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $GSE18804_SPLEEN_MACROPHAGE_VS_TUMORAL_MACROPHAGE_UP</span></span>
<span><span class="co">#&gt; [1] "22"     "9429"   "55860"  "1645"   "347902" "302"   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $GSE22886_NEUTROPHIL_VS_DC_UP</span></span>
<span><span class="co">#&gt; [1] "101"    "84658"  "222487" "2334"   "57538"  "200315"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $GSE22886_NEUTROPHIL_VS_MONOCYTE_UP</span></span>
<span><span class="co">#&gt; [1] "8748"   "222487" "306"    "25825"  "699"    "762"   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $GSE2585_THYMIC_MACROPHAGE_VS_MTEC_UP</span></span>
<span><span class="co">#&gt; [1] "10347" "10449" "2015"  "3268"  "10327" "334"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/GSVA/man/geneSets.html" class="external-link">geneSetSizes</a></span><span class="op">(</span><span class="va">es</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; GSE18804_SPLEEN_MACROPHAGE_VS_BRAIN_TUMORAL_MACROPHAGE_UP </span></span>
<span><span class="co">#&gt;                                                       122 </span></span>
<span><span class="co">#&gt; GSE18804_SPLEEN_MACROPHAGE_VS_COLON_TUMORAL_MACROPHAGE_UP </span></span>
<span><span class="co">#&gt;                                                       141 </span></span>
<span><span class="co">#&gt;       GSE18804_SPLEEN_MACROPHAGE_VS_TUMORAL_MACROPHAGE_UP </span></span>
<span><span class="co">#&gt;                                                       147 </span></span>
<span><span class="co">#&gt;                              GSE22886_NEUTROPHIL_VS_DC_UP </span></span>
<span><span class="co">#&gt;                                                       105 </span></span>
<span><span class="co">#&gt;                        GSE22886_NEUTROPHIL_VS_MONOCYTE_UP </span></span>
<span><span class="co">#&gt;                                                        82 </span></span>
<span><span class="co">#&gt;                      GSE2585_THYMIC_MACROPHAGE_VS_MTEC_UP </span></span>
<span><span class="co">#&gt;                                                       142</span></span></code></pre></div>
</div>
<div class="section level2" number="5">
<h2 id="data-exploration-at-pathway-level">
<span class="header-section-number">5</span> Data exploration at pathway level<a class="anchor" aria-label="anchor" href="#data-exploration-at-pathway-level"></a>
</h2>
<p>We do again a data exploration, this time at pathway level. Figure
<a href="#fig:pathwaylevelmds">5.1</a> below, shows an MDS plot of GSVA enrichment scores.
We can see again that most variability is driven by the FIR phenotype, but this
time the sex phenotype does not seem to affect sample dissimilarity at pathway
level, probably because the collection of gene sets we have used does not
include gene sets formed by genes with sex-specific expression.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/limma/man/plotMDS.html" class="external-link">plotMDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">es</span><span class="op">)</span>, col<span class="op">=</span><span class="va">fircolor</span><span class="op">[</span><span class="va">es</span><span class="op">$</span><span class="va">FIR</span><span class="op">]</span>, pch<span class="op">=</span><span class="va">sexpch</span><span class="op">[</span><span class="va">es</span><span class="op">$</span><span class="va">Sex</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:pathwaylevelmds"></span>
<img src="bulkRNAseq_files/figure-html/pathwaylevelmds-1.png" alt="Pathway-level exploration. Multidimensional scaling (MDS) plot at pathway level. Red corresponds to `FIR=yes` and blue to `FIR=no`, while circles and squares correspond, respectively, to female and male neonates."><p class="caption">
Figure 5.1: Pathway-level exploration. Multidimensional scaling (MDS) plot at pathway level. Red corresponds to <code>FIR=yes</code> and blue to <code>FIR=no</code>, while circles and squares correspond, respectively, to female and male neonates.
</p>
</div>
</div>
<div class="section level2" number="6">
<h2 id="differential-expression-at-pathway-level">
<span class="header-section-number">6</span> Differential expression at pathway level<a class="anchor" aria-label="anchor" href="#differential-expression-at-pathway-level"></a>
</h2>
<p>One of the most common pathway-centric analyses is a differential expression
analysis at pathway level. We conduct such an analysis using the Bioconductor
packages <a href="https://bioconductor.org/packages/limma" class="external-link">limma</a> and
<a href="https://bioconductor.org/packages/sva" class="external-link">sva</a>, the latter to adjust for sample
heterogeneity using surrogate variable analysis <span class="citation">(<a href="#ref-leek2007capturing">Leek and Storey 2007</a>)</span>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">sva</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioinf.wehi.edu.au/limma/" class="external-link">limma</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## build design matrix of the model to which we fit the data</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span> <span class="va">FIR</span>, <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">es</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## build design matrix of the corresponding null model</span></span>
<span><span class="va">mod0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">es</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## estimate surrogate variables (SVs) with SVA</span></span>
<span><span class="va">sv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sva/man/sva.html" class="external-link">sva</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">es</span><span class="op">)</span>, <span class="va">mod</span>, <span class="va">mod0</span><span class="op">)</span></span>
<span><span class="co">#&gt; Number of significant surrogate variables is:  4 </span></span>
<span><span class="co">#&gt; Iteration (out of 5 ):1  2  3  4  5</span></span>
<span><span class="co">## add SVs to the design matrix of the model of interest</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">mod</span>, <span class="va">sv</span><span class="op">$</span><span class="va">sv</span><span class="op">)</span></span>
<span><span class="co">## fit linear models</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/limma/man/lmFit.html" class="external-link">lmFit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">es</span><span class="op">)</span>, <span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">## calculate moderated t-statistics</span></span>
<span><span class="va">fit.eb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/limma/man/ebayes.html" class="external-link">eBayes</a></span><span class="op">(</span><span class="va">fit</span>, robust<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## summarize the extent of differential expression at 5% FDR</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/limma/man/decideTests.html" class="external-link">decideTests</a></span><span class="op">(</span><span class="va">fit.eb</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="co">#&gt;        (Intercept) FIRyes                </span></span>
<span><span class="co">#&gt; Down            24     12  39  39  33  55</span></span>
<span><span class="co">#&gt; NotSig         118    100  64  79  69  92</span></span>
<span><span class="co">#&gt; Up               8     38  47  32  48   3</span></span></code></pre></div>
<p>As shown in Figure <a href="#fig:esstdevxgssize">6.1</a> below, GSVA scores tend to have
higher precision for larger gene sets, albeit this trend breaks at the end of
gene set sizes in this case. This trend is usually more clear when GSVA scores
are derived from gene sets including smaller sizes (our smallest gene set here
is about 100 genes), and from less heterogenous expression data.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gssizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GSVA/man/geneSets.html" class="external-link">geneSetSizes</a></span><span class="op">(</span><span class="va">es</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">gssizes</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">fit.eb</span><span class="op">$</span><span class="va">sigma</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"Sqrt(gene sets sizes)"</span>,</span>
<span>          ylab<span class="op">=</span><span class="st">"Sqrt(standard deviation)"</span>, las<span class="op">=</span><span class="fl">1</span>, pch<span class="op">=</span><span class="st">"."</span>, cex<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lowess.html" class="external-link">lowess</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">gssizes</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">fit.eb</span><span class="op">$</span><span class="va">sigma</span><span class="op">)</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"red"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:esstdevxgssize"></span>
<img src="bulkRNAseq_files/figure-html/esstdevxgssize-1.png" alt="Pathway-level differential expression analysis. Residual standard deviation of GSVA scores as a function of gene set size. Larger gene sets tend to have higher precision."><p class="caption">
Figure 6.1: Pathway-level differential expression analysis. Residual standard deviation of GSVA scores as a function of gene set size. Larger gene sets tend to have higher precision.
</p>
</div>
<p>When this trend is present, we may improve the statistical power to detect
differentially expressed (DE) pathways by using the limma-trend pipeline. More
concretely, we should call the <code><a href="https://rdrr.io/pkg/limma/man/ebayes.html" class="external-link">eBayes()</a></code> function with the argument <code>trend=x</code>,
where <code>x</code> is a vector of values corresponding to the sizes of the gene sets.
As we have already seen, the values of these sizes can be easily obtained using
GSVA’s function <code><a href="https://rdrr.io/pkg/GSVA/man/geneSets.html" class="external-link">geneSetSizes()</a></code> on the output of the <code><a href="https://rdrr.io/pkg/GSVA/man/gsva.html" class="external-link">gsva()</a></code> function. Here
below, we call again <code><a href="https://rdrr.io/pkg/limma/man/ebayes.html" class="external-link">eBayes()</a></code> using the <code>trend</code> parameter. In this case,
however, there is no change in the number of FIR DE pathways.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.eb.trend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/limma/man/ebayes.html" class="external-link">eBayes</a></span><span class="op">(</span><span class="va">fit</span>, robust<span class="op">=</span><span class="cn">TRUE</span>, trend<span class="op">=</span><span class="va">gssizes</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/limma/man/decideTests.html" class="external-link">decideTests</a></span><span class="op">(</span><span class="va">fit.eb.trend</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="co">#&gt;        (Intercept) FIRyes                </span></span>
<span><span class="co">#&gt; Down            24     13  39  41  34  57</span></span>
<span><span class="co">#&gt; NotSig         121     98  64  75  69  90</span></span>
<span><span class="co">#&gt; Up               5     39  47  34  47   3</span></span></code></pre></div>
<p>We can select DE pathways with FDR &lt; 5% as follows.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/limma/man/toptable.html" class="external-link">topTable</a></span><span class="op">(</span><span class="va">fit.eb.trend</span>, coef<span class="op">=</span><span class="fl">2</span>, n<span class="op">=</span><span class="cn">Inf</span><span class="op">)</span></span>
<span><span class="va">DEpwys</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">tt</span><span class="op">)</span><span class="op">[</span><span class="va">tt</span><span class="op">$</span><span class="va">adj.P.Val</span> <span class="op">&lt;=</span> <span class="fl">0.05</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">DEpwys</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 52</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">DEpwys</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "GSE3039_CD4_TCELL_VS_ALPHABETA_CD8_TCELL_UP"           </span></span>
<span><span class="co">#&gt; [2] "GSE3982_NEUTROPHIL_VS_CENT_MEMORY_CD4_TCELL_UP"        </span></span>
<span><span class="co">#&gt; [3] "GSE3982_EOSINOPHIL_VS_CENT_MEMORY_CD4_TCELL_UP"        </span></span>
<span><span class="co">#&gt; [4] "GSE36392_EOSINOPHIL_VS_NEUTROPHIL_IL25_TREATED_LUNG_UP"</span></span>
<span><span class="co">#&gt; [5] "GSE3982_NEUTROPHIL_VS_TH2_UP"                          </span></span>
<span><span class="co">#&gt; [6] "GSE22886_NEUTROPHIL_VS_DC_UP"</span></span></code></pre></div>
<p>Figure <a href="#fig:heatmapdepwys">6.2</a> below shows a heatmap of the GSVA enrichment
scores of the subset of the 52 DE pathways, clustered by
pathway and sample. We may observe that, consistently with the findings of
<span class="citation">Costa et al. (<a href="#ref-costa2021genome">2021</a>)</span>, FIR-affected neonates display an enrichment of upregulated
pathways associated with innate immunity, and an enrichment of downregulated
pathways associated with adaptive immunity, with respect to
FIR-unaffected neonates.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DEpwys_es</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/limma/man/removeBatchEffect.html" class="external-link">removeBatchEffect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">es</span><span class="op">[</span><span class="va">DEpwys</span>, <span class="op">]</span><span class="op">)</span>,</span>
<span>                               covariates<span class="op">=</span><span class="va">mod</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                               design<span class="op">=</span><span class="va">mod</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; Coefficients not estimable: FIRyes</span></span>
<span><span class="va">sam_col_map</span> <span class="op">&lt;-</span> <span class="va">fircolor</span><span class="op">[</span><span class="va">es</span><span class="op">$</span><span class="va">FIR</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sam_col_map</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">DEpwys_es</span><span class="op">)</span></span>
<span><span class="va">sampleClust</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">DEpwys_es</span>, method<span class="op">=</span><span class="st">"spearman"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      method<span class="op">=</span><span class="st">"complete"</span><span class="op">)</span></span>
<span><span class="va">gsetClust</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">DEpwys_es</span><span class="op">)</span>, method<span class="op">=</span><span class="st">"pearson"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                    method<span class="op">=</span><span class="st">"complete"</span><span class="op">)</span></span>
<span><span class="va">labrow</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">DEpwys_es</span><span class="op">)</span></span>
<span><span class="va">mask</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">DEpwys_es</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="va">innategsets</span></span>
<span><span class="va">labrow</span><span class="op">[</span><span class="va">mask</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"(INNATE)"</span>, <span class="va">labrow</span><span class="op">[</span><span class="va">mask</span><span class="op">]</span>, sep<span class="op">=</span><span class="st">"_"</span><span class="op">)</span></span>
<span><span class="va">mask</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">DEpwys_es</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="va">adaptivegsets</span></span>
<span><span class="va">labrow</span><span class="op">[</span><span class="va">mask</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"(ADAPTIVE)"</span>, <span class="va">labrow</span><span class="op">[</span><span class="va">mask</span><span class="op">]</span>, sep<span class="op">=</span><span class="st">"_"</span><span class="op">)</span></span>
<span><span class="va">labrow</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"_"</span>, <span class="st">" "</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"GSE[0-9]+_"</span>, <span class="st">""</span>, <span class="va">labrow</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html" class="external-link">heatmap</a></span><span class="op">(</span><span class="va">DEpwys_es</span>, ColSideColors<span class="op">=</span><span class="va">fircolor</span><span class="op">[</span><span class="va">es</span><span class="op">$</span><span class="va">FIR</span><span class="op">]</span>, xlab<span class="op">=</span><span class="st">"Samples"</span>,</span>
<span>        ylab<span class="op">=</span><span class="st">"Pathways"</span>, margins<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">20</span><span class="op">)</span>, labCol<span class="op">=</span><span class="st">""</span>, labRow<span class="op">=</span><span class="va">labrow</span>,</span>
<span>        scale<span class="op">=</span><span class="st">"row"</span>, Colv<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">as.dendrogram</a></span><span class="op">(</span><span class="va">sampleClust</span><span class="op">)</span>,</span>
<span>        Rowv<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">as.dendrogram</a></span><span class="op">(</span><span class="va">gsetClust</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:heatmapdepwys"></span>
<img src="bulkRNAseq_files/figure-html/heatmapdepwys-1.png" alt="Pathway-level signature of FIR. Heatmap of GSVA enrichment scores from pathways being called DE with 5% FDR between FIR-affected and unaffected neonates."><p class="caption">
Figure 6.2: Pathway-level signature of FIR. Heatmap of GSVA enrichment scores from pathways being called DE with 5% FDR between FIR-affected and unaffected neonates.
</p>
</div>
</div>
<div class="section level2" number="7">
<h2 id="session-information">
<span class="header-section-number">7</span> Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.4.1 (2024-06-14)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.4 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Etc/UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">#&gt; [8] base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] sva_3.53.0                  BiocParallel_1.39.0        </span></span>
<span><span class="co">#&gt;  [3] genefilter_1.87.0           mgcv_1.9-1                 </span></span>
<span><span class="co">#&gt;  [5] nlme_3.1-166                org.Hs.eg.db_3.19.1        </span></span>
<span><span class="co">#&gt;  [7] limma_3.61.9                GSVA_1.53.16               </span></span>
<span><span class="co">#&gt;  [9] GSEABase_1.67.0             graph_1.83.0               </span></span>
<span><span class="co">#&gt; [11] annotate_1.83.0             XML_3.99-0.17              </span></span>
<span><span class="co">#&gt; [13] AnnotationDbi_1.67.0        SummarizedExperiment_1.35.1</span></span>
<span><span class="co">#&gt; [15] Biobase_2.65.1              GenomicRanges_1.57.1       </span></span>
<span><span class="co">#&gt; [17] GenomeInfoDb_1.41.1         IRanges_2.39.2             </span></span>
<span><span class="co">#&gt; [19] S4Vectors_0.43.2            BiocGenerics_0.51.0        </span></span>
<span><span class="co">#&gt; [21] MatrixGenerics_1.17.0       matrixStats_1.3.0          </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] blob_1.2.4                  Biostrings_2.73.1          </span></span>
<span><span class="co">#&gt;  [3] fastmap_1.2.0               SingleCellExperiment_1.27.2</span></span>
<span><span class="co">#&gt;  [5] digest_0.6.37               rsvd_1.0.5                 </span></span>
<span><span class="co">#&gt;  [7] lifecycle_1.0.4             survival_3.7-0             </span></span>
<span><span class="co">#&gt;  [9] statmod_1.5.0               KEGGREST_1.45.1            </span></span>
<span><span class="co">#&gt; [11] RSQLite_2.3.7               magrittr_2.0.3             </span></span>
<span><span class="co">#&gt; [13] compiler_4.4.1              rlang_1.1.4                </span></span>
<span><span class="co">#&gt; [15] sass_0.4.9                  tools_4.4.1                </span></span>
<span><span class="co">#&gt; [17] yaml_2.3.10                 knitr_1.48                 </span></span>
<span><span class="co">#&gt; [19] S4Arrays_1.5.7              htmlwidgets_1.6.4          </span></span>
<span><span class="co">#&gt; [21] bit_4.0.5                   DelayedArray_0.31.11       </span></span>
<span><span class="co">#&gt; [23] abind_1.4-5                 HDF5Array_1.33.6           </span></span>
<span><span class="co">#&gt; [25] grid_4.4.1                  beachmat_2.21.5            </span></span>
<span><span class="co">#&gt; [27] xtable_1.8-4                edgeR_4.3.13               </span></span>
<span><span class="co">#&gt; [29] Rhdf5lib_1.27.0             cli_3.6.3                  </span></span>
<span><span class="co">#&gt; [31] rmarkdown_2.28              crayon_1.5.3               </span></span>
<span><span class="co">#&gt; [33] httr_1.4.7                  rjson_0.2.22               </span></span>
<span><span class="co">#&gt; [35] DBI_1.2.3                   cachem_1.1.0               </span></span>
<span><span class="co">#&gt; [37] rhdf5_2.49.0                zlibbioc_1.51.1            </span></span>
<span><span class="co">#&gt; [39] splines_4.4.1               parallel_4.4.1             </span></span>
<span><span class="co">#&gt; [41] XVector_0.45.0              vctrs_0.6.5                </span></span>
<span><span class="co">#&gt; [43] Matrix_1.7-0                jsonlite_1.8.8             </span></span>
<span><span class="co">#&gt; [45] bookdown_0.40               BiocSingular_1.21.2        </span></span>
<span><span class="co">#&gt; [47] bit64_4.0.5                 irlba_2.3.5.1              </span></span>
<span><span class="co">#&gt; [49] magick_2.8.4                locfit_1.5-9.10            </span></span>
<span><span class="co">#&gt; [51] jquerylib_0.1.4             codetools_0.2-20           </span></span>
<span><span class="co">#&gt; [53] UCSC.utils_1.1.0            ScaledMatrix_1.13.0        </span></span>
<span><span class="co">#&gt; [55] htmltools_0.5.8.1           rhdf5filters_1.17.0        </span></span>
<span><span class="co">#&gt; [57] GenomeInfoDbData_1.2.12     R6_2.5.1                   </span></span>
<span><span class="co">#&gt; [59] sparseMatrixStats_1.17.2    evaluate_0.24.0            </span></span>
<span><span class="co">#&gt; [61] lattice_0.22-6              highr_0.11                 </span></span>
<span><span class="co">#&gt; [63] png_0.1-8                   SpatialExperiment_1.15.1   </span></span>
<span><span class="co">#&gt; [65] memoise_2.0.1               bslib_0.8.0                </span></span>
<span><span class="co">#&gt; [67] Rcpp_1.0.13                 SparseArray_1.5.31         </span></span>
<span><span class="co">#&gt; [69] xfun_0.47                   pkgconfig_2.0.3</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-costa2021genome" class="csl-entry">
Costa, Daniel, Núria Bonet, Amanda Solé, José Manuel González de Aledo-Castillo, Eduard Sabidó, Ferran Casals, Carlota Rovira, et al. 2021. <span>“Genome-Wide Postnatal Changes in Immunity Following Fetal Inflammatory Response.”</span> <em>The FEBS Journal</em> 288 (7): 2311–31. <a href="https://doi.org/10.1111/febs.15578" class="external-link">https://doi.org/10.1111/febs.15578</a>.
</div>
<div id="ref-hanzelmann2013gsva" class="csl-entry">
Hänzelmann, Sonja, Robert Castelo, and Justin Guinney. 2013. <span>“GSVA: Gene Set Variation Analysis for Microarray and RNA-Seq Data.”</span> <em>BMC Bioinformatics</em> 14: 1–15. <a href="https://doi.org/10.1186/1471-2105-14-7" class="external-link">https://doi.org/10.1186/1471-2105-14-7</a>.
</div>
<div id="ref-leek2007capturing" class="csl-entry">
Leek, Jeffrey T, and John D Storey. 2007. <span>“Capturing Heterogeneity in Gene Expression Studies by Surrogate Variable Analysis.”</span> <em>PLoS Genetics</em> 3 (9): e161. <a href="https://doi.org/10.1371/journal.pgen.0030161" class="external-link">https://doi.org/10.1371/journal.pgen.0030161</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Robert Castelo, Axel Klenk.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
