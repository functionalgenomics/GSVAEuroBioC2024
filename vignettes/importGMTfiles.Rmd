---
title: "Import gene sets from GMT files"
author:
  - name: Axel Klenk
    affiliation: Dept. of Medicine and Life Sciences, Universitat Pompeu Fabra, Barcelona
    email: axelvolker.klenk@upf.edu
  - name: Robert Castelo
    affiliation: Dept. of Medicine and Life Sciences, Universitat Pompeu Fabra, Barcelona
    email: robert.castelo@upf.edu
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Import gene sets from GMT files}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
bibliography: GSVAEuroBioC2024.bib
---


```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# What are GMT files

An important source of gene sets is the
[Molecular Signatures Database](https://www.gsea-msigdb.org/gsea/msigdb)
[@subramanian2005gene], which stores them in plain text files following the
so-called
[_gene matrix transposed_ (GMT) format](https://software.broadinstitute.org/cancer/software/gsea/wiki/index.php/Data_formats#GMT:_Gene_Matrix_Transposed_file_format_.28.2A.gmt.29).
In the GMT format, each line stores a gene set with the following values
separated by tabs:

  * A gene set identifier.
  * A gene set description.
  * One or more gene identifiers.

Because each different gene set may consist of a different number of genes, each
line in a GMT file may contain a different number of tab-separated values.

# How to read GMT files

We can read GMT files using the `readGMT()` function from the GSVA package.

```{r}
library(GSVA)

URL <- "https://data.broadinstitute.org/gsea-msigdb/msigdb/release/2023.2.Hs/c7.immunesigdb.v2023.2.Hs.symbols.gmt"
genesets <- readGMT(URL, geneIdType=SymbolIdentifier())
length(genesets)
genesets
```

# Session information

```{r}
sessionInfo()
```

# References
